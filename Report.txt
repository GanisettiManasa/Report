Report Query

SELECT CONCAT(
    'In our DMart, Vizag, we are selling over ', 
    (SELECT COUNT(*) FROM Item), 
    ' different items like ',  
    (SELECT GROUP_CONCAT(Description SEPARATOR ', ') FROM Item), 
    '. Currently, we have ', 
    (SELECT SUM(StockQty) FROM Item), 
    ' pcs in stock across all categories. The most sold item is ', 
    (SELECT Description FROM Item JOIN BillDetail ON Item.ItemId = BillDetail.ItemId GROUP BY Item.ItemId ORDER BY SUM(BillDetail.SoldQty) DESC LIMIT 1), 
    '. The least sold item is ', 
    (SELECT Description FROM Item JOIN BillDetail ON Item.ItemId = BillDetail.ItemId GROUP BY Item.ItemId ORDER BY SUM(BillDetail.SoldQty) ASC LIMIT 1), 
    '. We are working with ',  
    (SELECT COUNT(DISTINCT SupplierId) FROM Item), 
    ' different suppliers to source our products. Our suppliers include ', 
    (SELECT GROUP_CONCAT(SupplierName SEPARATOR ', ') FROM Supplier), 
    '. The highest revenue was generated by ', 
    (SELECT Description FROM Item  ORDER BY Price * (SELECT SUM(SoldQty) FROM BillDetail WHERE ItemId = Item.ItemId) DESC LIMIT 1), 
    ' contributing ', 
    (SELECT Price * (SELECT SUM(SoldQty) FROM BillDetail WHERE ItemId = Item.ItemId) AS TotalRevenue FROM Item ORDER BY TotalRevenue DESC LIMIT 1), 
    ' to the total revenue. Our lowest revenue generator is ', 
    (SELECT Description FROM Item  ORDER BY Price * (SELECT SUM(SoldQty) FROM BillDetail WHERE ItemId = Item.ItemId) ASC LIMIT 1), 
    ' with total revenue of ', 
    (SELECT Price * (SELECT SUM(SoldQty) FROM BillDetail WHERE ItemId = Item.ItemId) AS TotalRevenue FROM Item ORDER BY TotalRevenue ASC LIMIT 1), 
    '. The following items need to be restocked soon based on low stock levels. Item ', 
    (SELECT Description FROM Item ORDER BY StockQty ASC LIMIT 1), 
    ' is currently down to ', 
    (SELECT StockQty FROM Item ORDER BY StockQty ASC LIMIT 1), 
    ' pcs. Another item, ', 
    (SELECT Description FROM Item ORDER BY StockQty ASC LIMIT 2,1), 
    ' has ', 
    (SELECT StockQty FROM Item ORDER BY StockQty ASC LIMIT 2,1), 
    ' pcs remaining. It is recommended to reorder these items before stock runs out. Over the past month, sales have been trending with a total of ', 
    (SELECT SUM(Item.Price * BillDetail.SoldQty) FROM BillDetail JOIN Item ON BillDetail.ItemId = Item.ItemId), 
    ' in revenue. Our busiest day was ', 
    (SELECT BillDate FROM BillHeader GROUP BY BillDate ORDER BY (SELECT SUM(BillDetail.SoldQty * Item.Price) FROM BillDetail JOIN Item ON BillDetail.ItemId = Item.ItemId WHERE BillDetail.BillNumber = BillHeader.BillNumber) DESC LIMIT 1), 
    ' with a total of ', 
    (SELECT SUM(BillDetail.SoldQty * Item.Price) AS TotalSales FROM BillHeader JOIN BillDetail ON BillHeader.BillNumber = BillDetail.BillNumber JOIN Item ON BillDetail.ItemId = Item.ItemId GROUP BY BillDate ORDER BY TotalSales DESC LIMIT 1), 
    ' in sales. The slowest day was ', 
    (SELECT BillDate FROM BillHeader GROUP BY BillDate ORDER BY (SELECT SUM(BillDetail.SoldQty * Item.Price) FROM BillDetail JOIN Item ON BillDetail.ItemId = Item.ItemId WHERE BillDetail.BillNumber = BillHeader.BillNumber) ASC LIMIT 1), 
    ' with only ', 
    (SELECT SUM(BillDetail.SoldQty * Item.Price) AS TotalSales FROM BillHeader JOIN BillDetail ON BillHeader.BillNumber = BillDetail.BillNumber JOIN Item ON BillDetail.ItemId = Item.ItemId GROUP BY BillDate ORDER BY TotalSales ASC LIMIT 1), 
    ' in sales.'
) AS Full_Report \G


Output:

Full_Report: In our DMart, Vizag, we are selling over 5 different items like Laptop, Fridge, Telivision, USB Cable, MacBook. Currently, we have 64 pcs in stock across all categories. The most sold item is MacBook. The least sold item is Telivision. We are working with 5 different suppliers to source our products. Our suppliers include Lenovo, Whirlpool, Samsung, Vivo, Apple. The highest revenue was generated by MacBook contributing 1200000 to the total revenue. Our lowest revenue generator is USB Cable with total revenue of 3000. The following items need to be restocked soon based on low stock levels. Item Telivision is currently down to 7 pcs. Another item, MacBook has 13 pcs remaining. It is recommended to reorder these items before stock runs out. Over the past month, sales have been trending with a total of 1428000 in revenue. Our busiest day was 2024-08-26 with a total of 800000 in sales. The slowest day was 2024-08-27 with only 40000 in sales.